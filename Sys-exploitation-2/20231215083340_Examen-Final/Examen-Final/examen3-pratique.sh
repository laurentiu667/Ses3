#!/bin/bash
#---------------------------------------------------
#Script créé par : Laurentiu Dilion
#Crée le 2023-12-15
echo "Nom : Laurentiu Dilion"
current_date=$(date "+%Y-%m-%d")
echo "Date de la création du script : $current_date"
#---------------------------------------------------

#Étape 1
echo "Création du premier dossier"
sudo mkdir /examen_c32/ -m 755

#Étape 2
echo "Création des groupes"
sudo groupadd ginfo2023
sudo groupadd ada
sudo groupadd rust
# étape 3
echo "Création des utilisateurs"
sudo useradd -g ada -m -s /bin/bash ada
sudo useradd -g rust -m -s /bin/bash rust

echo "Définition des mots de passe"
echo "ada:Secret1" | sudo chpasswd
echo "rust:Secret1" | sudo chpasswd

echo "Définition des mots de passe SAMBA"
echo -e 'Secret1\nSecret1' | sudo smbpasswd -s -a ada
echo -e 'Secret1\nSecret1' | sudo smbpasswd -s -a rust

#Étape 4
echo "Création des 10 utilisateurs"

for i in {101..110}; do
    username="linux$i"
    password="Secret1"
    user_home="/examen_c32/$username"

    # Créer l'utilisateur avec le groupe gprog2, le shell /bin/bash, et le dossier personnel sous /perso_prog/
    sudo useradd -g ginfo2023 -m -s /bin/bash -d $user_home $username

    # Définir le mot de passe pour l'utilisateur
    echo "$username:$password" | sudo chpasswd

    # Définir le mot de passe SAMBA pour l'utilisateur
    echo -e "$password\n$password" | sudo smbpasswd -s -a $username
done

#Étape 5
# Créer le dossier /info_c32/ avec les permissions appropriées
sudo mkdir /info_c32/ -m 775
sudo chown ada /info_c32/
sudo chgrp ada /info_c32/

